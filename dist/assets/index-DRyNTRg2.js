import{r,b as Ye,a as Qe}from"./react-BKU87Gzz.js";import{u as Je,L as Me,R as Xe,a as Z,B as Ve}from"./router-D7DzN0t-.js";import{a as ae}from"./vendor-B9HHbEsj.js";import{R as H,B as Ze,C as be,X as je,Y as ye,T as ee,a as ea,P as Ne,b as ve,c as we,L as Ce,d as aa,e as Se}from"./charts-Bv6ZdGAQ.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))p(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const c of d.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&p(c)}).observe(document,{childList:!0,subtree:!0});function h(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function p(l){if(l.ep)return;l.ep=!0;const d=h(l);fetch(l.href,d)}})();var Pe={exports:{}},Y={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sa=r,ta=Symbol.for("react.element"),oa=Symbol.for("react.fragment"),na=Object.prototype.hasOwnProperty,ra=sa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ia={key:!0,ref:!0,__self:!0,__source:!0};function De(a,i,h){var p,l={},d=null,c=null;h!==void 0&&(d=""+h),i.key!==void 0&&(d=""+i.key),i.ref!==void 0&&(c=i.ref);for(p in i)na.call(i,p)&&!ia.hasOwnProperty(p)&&(l[p]=i[p]);if(a&&a.defaultProps)for(p in i=a.defaultProps,i)l[p]===void 0&&(l[p]=i[p]);return{$$typeof:ta,type:a,key:d,ref:c,props:l,_owner:ra.current}}Y.Fragment=oa;Y.jsx=De;Y.jsxs=De;Pe.exports=Y;var e=Pe.exports,Re,ke=Ye;Re=ke.createRoot,ke.hydrateRoot;const se=(()=>{const a=[];if(typeof window<"u"){const i=window.location.host||"";/localhost|127\.0\.0\.1/.test(i)&&a.push("http://localhost:5175")}else a.push("http://localhost:5175");return a.push("https://checkin-backend.onrender.com"),Array.from(new Set(a.filter(Boolean)))})();async function Fe(a,i){let h=null;for(const p of se)try{return(await ae.get(`${p}${a}`,{timeout:5e3,...i||{}})).data}catch(l){h=l;continue}throw h||new Error("all_backends_failed")}async function T(a,i){let h=null;for(const p of se)try{return(await ae.post(`${p}${a}`,i,{timeout:5e3})).data}catch(l){h=l;continue}throw h||new Error("all_backends_failed")}async function la(a){try{return await T("/api/admin/login",a)}catch{return{ok:a.username.trim().toLowerCase()==="professor".toLowerCase()&&a.password==="0808"}}}async function ca(a){try{return await T("/api/checkin",a)}catch{const h="CHECKINS",p=localStorage.getItem(h)||"[]";let l=[];try{l=JSON.parse(p)}catch{l=[]}const d={...a,createdAt:new Date().toISOString()};l.unshift(d);try{localStorage.setItem(h,JSON.stringify(l))}catch{}return{ok:!0,local:!0}}}async function da(a){var i;try{return await Fe("/api/checkins",{params:{adminKey:a==null?void 0:a.adminKey,nome:a==null?void 0:a.nome,from:a==null?void 0:a.from,to:a==null?void 0:a.to}})}catch{const l=localStorage.getItem("CHECKINS")||"[]";let d=[];try{d=JSON.parse(l)}catch{d=[]}const c=(i=a==null?void 0:a.nome)==null?void 0:i.trim();return c&&(d=d.filter(M=>(M.nomeCompleto||"").toLowerCase().includes(c.toLowerCase()))),d}}async function ma(a){const i=se[0];return(await ae.post(`${i}/api/report/pdf`,a,{responseType:"blob"})).data}async function $e(a){return await T("/api/report/send",a)}async function ha(a){try{return await T("/api/admin/clear",a)}catch{if(!(a.adminKey==="0808"))return{ok:!1,deleted:0};const l="CHECKINS",d=localStorage.getItem(l)||"[]";let c=[];try{c=JSON.parse(d)}catch{c=[]}try{localStorage.setItem(l,"[]")}catch{}return{ok:!0,deleted:c.length}}}async function te(){try{return await Fe("/api/profile")}catch{return{photo:null,email:"",whatsapp:""}}}async function Ae(a){try{return await T("/api/profile",a)}catch{return{ok:!1}}}const pa={nomeCompleto:"",semanaTexto:"",diasMarcados:[],treinosForca:"0",evolucaoDesempenho:"Ainda não",treinoNaoCompletado:"",dorOuFadiga:"",cardioSessoes:"0",tipoCardio:"",duracaoCardio:"20",intensidadeCardio:"Leve",energiaGeral:"Média",sonoRecuperacao:"Regular",alimentacaoPlano:"Sim, em parte",motivacaoHumor:"Boa",ajusteProximaSemana:"",comentariosAdicionais:"",whatsapp:"",fotoPerfil:""};function ua(){const[a,i]=r.useState(pa),[h,p]=r.useState(!1),l=Je(),[d,c]=r.useState(null);r.useEffect(()=>{const t=g=>{g.preventDefault(),c(g)};return window.addEventListener("beforeinstallprompt",t),()=>window.removeEventListener("beforeinstallprompt",t)},[]);const M=async()=>{const t=/iPhone|iPad|iPod/i.test(navigator.userAgent),g=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone;try{if(d){d.prompt(),await d.userChoice,c(null);return}if(t&&!g){alert("No iPhone: toque em Compartilhar → Adicionar à Tela de Início.");return}alert("Para instalar, use o menu do navegador: “Adicionar à tela inicial”.")}catch{}},b=(t,g)=>{i(y=>({...y,[t]:g}))},[Q,S]=r.useState(null),[R,C]=r.useState("");r.useEffect(()=>{(async()=>{try{const t=await te();S(t.photo||null),C((t.whatsapp||"").replace(/\D/g,""))}catch{}})()},[]);const F=async t=>{var g;t.preventDefault();try{p(!0),await ca(a);const y="",N=(R||""||"").replace(/\D/g,"");try{await $e({...a,tipo:"checkin_submitted",adminEmail:y,adminWhatsapp:N})}catch{}if(N){const j=[`Novo check-in: ${a.nomeCompleto} — ${a.semanaTexto}`,`Treinos de força: ${a.treinosForca}`,`Evolução: ${a.evolucaoDesempenho}`,`Energia: ${a.energiaGeral}`,`Sono: ${a.sonoRecuperacao}`,`Alimentação: ${a.alimentacaoPlano}`,`Cardio: ${a.cardioSessoes} sessões (${a.tipoCardio}, ${a.duracaoCardio} min, ${a.intensidadeCardio})`,a.treinoNaoCompletado?`Treino não completado: ${a.treinoNaoCompletado}`:"",a.dorOuFadiga?`Dor/fadiga: ${a.dorOuFadiga}`:"",a.ajusteProximaSemana?`Ajuste próxima semana: ${a.ajusteProximaSemana}`:"",a.comentariosAdicionais?`Comentários: ${a.comentariosAdicionais}`:"",(g=a.diasMarcados)!=null&&g.length?`Dias marcados: ${a.diasMarcados.join(", ")}`:""].filter(Boolean),D=encodeURIComponent(j.join(`
`)),O=N,I=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),_=`whatsapp://send?phone=${O}&text=${D}`,B=`https://wa.me/${O}?text=${D}`;try{I&&(window.location.href=_)}catch{}setTimeout(()=>{try{window.location.href=B}catch{}},200)}l("/confirmation")}catch{alert("Erro ao enviar. Tente novamente.")}finally{p(!1)}},[f,$]=r.useState(()=>{const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1)}),E=r.useMemo(()=>f.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),[f]),A=r.useMemo(()=>{const t=new Date(f),y=new Date(f.getFullYear(),f.getMonth()+1,0).getDate(),v=t.getDay(),N=[];for(let j=0;j<v;j++)N.push(null);for(let j=1;j<=y;j++)N.push(j);return N},[f]),m=(t,g,y)=>{const v=String(g+1).padStart(2,"0"),N=String(y).padStart(2,"0");return`${t}-${v}-${N}`},P=t=>(a.diasMarcados||[]).includes(t),J=t=>{if(!t)return;const g=f.getFullYear(),y=f.getMonth(),v=m(g,y,t);i(N=>{const j=new Set(N.diasMarcados||[]);return j.has(v)?j.delete(v):j.add(v),{...N,diasMarcados:Array.from(j).sort()}})},L=()=>$(new Date(f.getFullYear(),f.getMonth()-1,1)),X=()=>$(new Date(f.getFullYear(),f.getMonth()+1,1));return e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-white/10 border border-white/20 overflow-hidden flex items-center justify-center",children:Q?e.jsx("img",{src:Q,alt:"Foto de perfil",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-xs opacity-70",children:"Foto de perfil"})}),e.jsx("h1",{className:"script-title text-3xl md:text-4xl",children:"personal Nat."})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Nome completo"}),e.jsx("input",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",value:a.nomeCompleto,onChange:t=>b("nomeCompleto",t.target.value),required:!0})]}),e.jsx("div",{className:"grid gap-1",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Semana de … até …"})}),e.jsxs("div",{className:"grid gap-2 rounded-lg border border-white/10 bg-white/5 p-2 w-[220px]",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("button",{type:"button",onClick:L,className:"px-1 py-0.5 rounded bg-white/10 hover:bg-white/20",children:"◀"}),e.jsx("span",{className:"font-semibold",children:E}),e.jsx("button",{type:"button",onClick:X,className:"px-1 py-0.5 rounded bg-white/10 hover:bg-white/20",children:"▶"})]}),e.jsx("div",{className:"grid grid-cols-7 text-center text-[11px] text-white/70",children:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].map(t=>e.jsx("div",{className:"py-1",children:t},t))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:A.map((t,g)=>{if(t===null)return e.jsx("div",{},g);const y=m(f.getFullYear(),f.getMonth(),t),v=P(y);return e.jsxs("button",{type:"button",onClick:()=>J(t),className:`relative w-8 h-8 rounded-md border border-white/10 bg-white/5 hover:bg-white/10 transition ${v?"ring-2 ring-blue-400":""}`,children:[e.jsx("span",{className:"text-[11px]",children:t}),v&&e.jsx("span",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-blue-400"})]},g)})}),a.diasMarcados&&a.diasMarcados.length>0&&e.jsxs("div",{className:"text-xs text-white/70",children:["Dias marcados: ",a.diasMarcados.join(", ")]})]})]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Quantos treinos de força/hipertrofia você fez esta semana?"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:["0","1-2","3-4","5+"].map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"treinosForca",checked:a.treinosForca===t,onChange:()=>b("treinosForca",t)}),e.jsx("span",{children:t==="5+"?"5 ou mais":t})]},t))})]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Sentiu evolução no desempenho (carga, repetições, técnica)?"}),["Sim, bastante","Sim, um pouco","Ainda não"].map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"evolucao",checked:a.evolucaoDesempenho===t,onChange:()=>b("evolucaoDesempenho",t)}),e.jsx("span",{children:t})]},t))]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Teve algum treino que não conseguiu completar? Qual e por quê?"}),e.jsx("textarea",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",rows:3,value:a.treinoNaoCompletado,onChange:t=>b("treinoNaoCompletado",t.target.value)})]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Sentiu alguma dor, desconforto ou fadiga além do habitual? Se sim, onde/como?"}),e.jsx("textarea",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",rows:3,value:a.dorOuFadiga,onChange:t=>b("dorOuFadiga",t.target.value)})]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Quantas sessões de cardio você fez essa semana?"}),["0","1-2","3-4","5+"].map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"cardioSessoes",checked:a.cardioSessoes===t,onChange:()=>b("cardioSessoes",t)}),e.jsx("span",{children:t==="5+"?"5 ou mais":t})]},t))]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Tipo de cardio feito"}),e.jsx("input",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",value:a.tipoCardio,onChange:t=>b("tipoCardio",t.target.value)})]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Duração média de cada sessão"}),["20","30","45+"].map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"duracaoCardio",checked:a.duracaoCardio===t,onChange:()=>b("duracaoCardio",t)}),e.jsx("span",{children:t==="45+"?"45+ min":`${t} min`})]},t))]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Intensidade do cardio"}),["Leve","Moderada","Alta"].map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"intensidadeCardio",checked:a.intensidadeCardio===t,onChange:()=>b("intensidadeCardio",t)}),e.jsx("span",{children:t})]},t))]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Energia/disposição geral essa semana"}),["Excelente","Boa","Média","Baixa"].map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"energiaGeral",checked:a.energiaGeral===t,onChange:()=>b("energiaGeral",t)}),e.jsx("span",{children:t})]},t))]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Sono e recuperação"}),["Muito bom","Bom","Regular","Ruim"].map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"sonoRecuperacao",checked:a.sonoRecuperacao===t,onChange:()=>b("sonoRecuperacao",t)}),e.jsx("span",{children:t})]},t))]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Alimentação seguiu conforme o plano indicado?"}),["Sim, totalmente","Sim, em parte","Não muito"].map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"alimentacaoPlano",checked:a.alimentacaoPlano===t,onChange:()=>b("alimentacaoPlano",t)}),e.jsx("span",{children:t})]},t))]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Motivação e humor para treinar na próxima semana"}),["Muito alta","Boa","Média","Preciso de impulso"].map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"motivacaoHumor",checked:a.motivacaoHumor===t,onChange:()=>b("motivacaoHumor",t)}),e.jsx("span",{children:t})]},t))]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Quer que eu ajuste algo para a próxima semana?"}),e.jsx("textarea",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",rows:3,value:a.ajusteProximaSemana,onChange:t=>b("ajusteProximaSemana",t.target.value)})]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Comentários adicionais"}),e.jsx("textarea",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",rows:3,value:a.comentariosAdicionais,onChange:t=>b("comentariosAdicionais",t.target.value)})]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"WhatsApp (opcional)"}),e.jsx("input",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",value:a.whatsapp,onChange:t=>b("whatsapp",t.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:M,className:"px-3 py-2 rounded bg-white/10 hover:bg-white/20",children:"Instalar app"}),e.jsx("button",{type:"submit",className:"brand-btn",disabled:h,children:h?"Enviando…":"Enviar Check-in"})]})]})}const Ee=["#FF7A00","#aaa","#666","#fff"];function xa(){var he,pe;const[a,i]=r.useState(""),[h,p]=r.useState(""),[l,d]=r.useState(!1),[c,M]=r.useState([]),[b,Q]=r.useState(""),[S,R]=r.useState(""),[C,F]=r.useState(""),[f,$]=r.useState([]),[E,A]=r.useState(""),[m,P]=r.useState(null),[J,L]=r.useState(!1),[X,t]=r.useState(!1),[g,y]=r.useState(""),[v,N]=r.useState(!1),[j,D]=r.useState(!1),[O,I]=r.useState(!1),[_,B]=r.useState(!1),[oe,ne]=r.useState(null),[W,K]=r.useState(null),[re,ie]=r.useState(!1),[le,U]=r.useState("");r.useEffect(()=>{localStorage.removeItem("ADMIN_KEY"),localStorage.removeItem("ADMIN_USER"),(async()=>{try{const s=await te();ne(s.photo||null),R((s.email||"").trim()),F((s.whatsapp||"").trim())}catch{R(""),F("")}})()},[]);const k=async(s,o)=>{const n=await da({adminKey:s,nome:o||void 0});M(n),o||$(n)},Le=async()=>{const s=h.trim(),o=a.trim();if(!s||!o)return alert("Informe usuário e senha");try{if(!(await la({username:s,password:o})).ok)throw new Error("invalid");await k(o),d(!0)}catch{alert("Usuário ou senha inválidos"),d(!1)}},Oe=()=>{y(""),t(!0)},Te=async()=>{const s=g.trim();if(!s)return alert("Informe a senha do administrador.");try{N(!0);const o=await ha({adminKey:s});if(!o.ok)throw new Error("failed");M([]),$([]),P(null);try{await k(s)}catch{}t(!1),alert(`Dados excluídos. Registros removidos: ${o.deleted}`)}catch{alert("Senha inválida ou erro ao excluir os dados.")}finally{N(!1)}},Ie=s=>new Promise((o,n)=>{const u=new FileReader;u.onerror=()=>n(new Error("failed_read")),u.onload=()=>{const x=String(u.result||""),w=new Image;w.onload=()=>{try{const q=w.width,z=w.height,ue=Math.min(1,1024/Math.max(q,z)),xe=Math.max(1,Math.round(q*ue)),ge=Math.max(1,Math.round(z*ue)),G=document.createElement("canvas");G.width=xe,G.height=ge;const fe=G.getContext("2d");if(!fe)return o(x);fe.drawImage(w,0,0,xe,ge);const He=G.toDataURL("image/jpeg",.85);o(He)}catch{o(x)}},w.onerror=()=>o(x),w.src=x},u.readAsDataURL(s)}),_e=s=>{var n;const o=(n=s.target.files)==null?void 0:n[0];o&&Ie(o).then(u=>K(u)).catch(()=>{const u=new FileReader;u.onload=()=>K(String(u.result||"")),u.readAsDataURL(o)})},Be=async()=>{ie(!0);try{if(!(await Ae({photo:W})).ok)throw new Error("invalid");ne(W||null),K(null),U("Foto atualizada. Todos os links exibirão a nova foto."),setTimeout(()=>U(""),5e3)}catch{alert("Erro ao salvar a foto.")}finally{ie(!1)}};r.useMemo(()=>{const s={};for(const o of c){const n=o.nomeCompleto,u=o.treinosForca==="0"?0:o.treinosForca==="1-2"?2:o.treinosForca==="3-4"?4:5;s[n]=(s[n]||0)+u}return Object.entries(s).map(([o,n])=>({name:o,count:n}))},[c]);const We=r.useMemo(()=>{const s=new Set;for(const o of f)o.nomeCompleto&&s.add(o.nomeCompleto);return Array.from(s).sort((o,n)=>o.localeCompare(n))},[f]),ce=r.useMemo(()=>{const s={};for(const o of f){const n=o.nomeCompleto;n&&(s[n]=(s[n]||0)+1)}return Object.entries(s).sort((o,n)=>o[0].localeCompare(n[0]))},[f]),Ke=r.useMemo(()=>c.map(o=>{const n=o.treinosForca==="0"?0:o.treinosForca==="1-2"?2:o.treinosForca==="3-4"?4:5;return{semana:o.semanaTexto&&o.semanaTexto.trim().length?o.semanaTexto:o.createdAt?new Date(o.createdAt).toLocaleDateString("pt-BR"):"",count:n}}).reverse(),[c]),de=r.useMemo(()=>{const s=["Muito bom","Bom","Regular","Ruim"],o={"Muito bom":0,Bom:0,Regular:0,Ruim:0};for(const n of c)o[n.sonoRecuperacao]++;return s.map(n=>({name:n,value:o[n]}))},[c]),Ue=r.useMemo(()=>{const s=["Excelente","Boa","Média","Baixa"],o=["Muito alta","Boa","Média","Preciso de impulso"],n=x=>s.indexOf(x),u=x=>o.indexOf(x);return c.map((x,w)=>({idx:w+1,energia:n(x.energiaGeral),motivacao:u(x.motivacaoHumor),nome:x.nomeCompleto}))},[c]),me=r.useMemo(()=>{const s=["Sim, totalmente","Sim, em parte","Não muito"],o={"Sim, totalmente":"#22c55e","Sim, em parte":"#f59e0b","Não muito":"#ef4444"},n={"Sim, totalmente":0,"Sim, em parte":0,"Não muito":0};for(const x of c)n[x.alimentacaoPlano]++;const u=c.length||1;return s.map(x=>({categoria:x,qtd:n[x],pct:Math.round(n[x]/u*100),color:o[x]}))},[c]),qe=async()=>{var x;const s=E||((x=c[0])==null?void 0:x.nomeCompleto)||"";if(!s)return alert("Selecione uma aluna para exportar.");const o=await ma({nome:s}),n=URL.createObjectURL(o),u=document.createElement("a");u.href=n,u.download=`relatorio-${s}.pdf`,u.click(),URL.revokeObjectURL(n)},ze=()=>{if(!c.length)return alert("Sem dados");I(!!S),B(!!C),D(!0)},Ge=async()=>{if(!c.length)return alert("Sem dados");const s=c[0],o=O&&!!S,n=_&&!!C;if(!o&&!n)return alert("Selecione pelo menos um canal (E-mail ou WhatsApp).");try{await $e({...s,tipo:"weekly_report",adminEmail:o?S:"",adminWhatsapp:n?C:""})}catch{}finally{D(!1)}if(n){const u=(C||"").replace(/\D/g,"");if(u){const x=[`Novo check-in: ${s.nomeCompleto} — ${s.semanaTexto||""}`,`Treinos de força: ${s.treinosForca}`,`Energia: ${s.energiaGeral}`,`Sono: ${s.sonoRecuperacao}`,`Alimentação: ${s.alimentacaoPlano}`].filter(Boolean),w=encodeURIComponent(x.join(`
`)),V=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),q=`whatsapp://send?phone=${u}&text=${w}`,z=`https://wa.me/${u}?text=${w}`;try{V&&(window.location.href=q)}catch{}setTimeout(()=>{try{window.location.href=z}catch{}},200)}}alert(`Relatório enviado${o?" por e-mail":""}${n?o?" e WhatsApp":" por WhatsApp":""}!`)};return l?e.jsxs("div",{className:"max-w-6xl mx-auto px-4 space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Painel de Administração"}),le&&e.jsx("div",{className:"px-3 py-2 rounded bg-green-600/20 border border-green-500/40 text-green-100",children:le}),e.jsxs("div",{className:"flex items-end justify-between flex-wrap gap-2",children:[e.jsx(Me,{to:"/",className:"brand-btn",children:"Voltar"}),e.jsxs("div",{className:"flex items-end gap-3 flex-wrap",children:[e.jsx("button",{className:"px-3 py-2 rounded bg-red-600 hover:bg-red-700",title:"Excluir todos os dados (requer senha)",onClick:Oe,children:"Excluir dados"}),e.jsx("button",{className:"px-3 py-2 rounded bg-white/10 hover:bg-white/20",title:"Todos os alunos",onClick:()=>{L(!0),A(""),k(a,void 0),window.scrollTo({top:0,behavior:"smooth"})},children:"👥"}),E&&e.jsxs("div",{className:"flex items-center gap-2 text-sm opacity-80",children:[e.jsxs("span",{children:["Filtrando: ",e.jsx("span",{className:"font-semibold",children:E})]}),e.jsx("button",{className:"px-2 py-1 rounded bg-white/10 hover:bg-white/20",onClick:()=>{A(""),k(a,void 0)},children:"Limpar filtro"})]}),e.jsxs("select",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",value:E,onChange:s=>{const o=s.target.value;A(o),k(a,o||void 0)},children:[e.jsx("option",{value:"",children:"Todas alunas"}),We.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("button",{className:"brand-btn",onClick:()=>k(a,E||void 0),children:"Atualizar"}),e.jsx("button",{className:"brand-btn",onClick:qe,children:"Exportar PDF"}),e.jsx("button",{className:"brand-btn",onClick:ze,children:"Enviar Relatório"})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-[280px_1fr]",children:[e.jsx("aside",{className:"hidden md:block",children:e.jsxs("div",{className:"bg-white rounded p-4 text-black",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Alunas (checklists enviados)"}),e.jsx("div",{className:"grid gap-2",children:ce.map(([s,o])=>e.jsxs("button",{className:"text-left px-3 py-2 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>{A(s),k(a,s),window.scrollTo({top:0,behavior:"smooth"})},children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsxs("span",{className:"ml-2 text-sm opacity-70",children:["(",o,")"]})]},s))})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("section",{className:"bg-white/5 rounded p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Configurações de contato"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("label",{className:"grid gap-1",children:[e.jsx("span",{className:"text-sm opacity-80",children:"E-mail do treinador"}),e.jsx("input",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",placeholder:"ex: seuemail@dominio.com",value:S,onChange:s=>R(s.target.value)})]}),e.jsxs("label",{className:"grid gap-1",children:[e.jsx("span",{className:"text-sm opacity-80",children:"WhatsApp do treinador (com DDD)"}),e.jsx("input",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",placeholder:"ex: 5599999999999",value:C,onChange:s=>F(s.target.value)})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("button",{className:"brand-btn",onClick:async()=>{try{if(!(await Ae({email:S,whatsapp:C})).ok)throw new Error("invalid");U("Configurações salvas. Todos os links foram atualizados."),setTimeout(()=>U(""),5e3)}catch{alert("Erro ao salvar contato")}},children:"Salvar"})})]}),e.jsxs("section",{className:"bg-white rounded p-4 text-black grid gap-3",children:[e.jsx("h3",{className:"font-semibold",children:"Foto de perfil do site"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 rounded-full bg-gray-200 overflow-hidden flex items-center justify-center",children:W||oe?e.jsx("img",{src:W||oe||"",alt:"Foto do site",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-xs opacity-70",children:"Sem foto"})}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:_e}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:()=>K(null),children:"Remover"}),e.jsx("button",{className:"brand-btn",type:"button",onClick:Be,disabled:re,children:re?"Salvando…":"Salvar foto"})]})]})]}),e.jsx("p",{className:"text-sm opacity-70",children:"A foto é fixa no site e pode ser alterada diretamente por quem tiver acesso a este painel."})]}),e.jsxs("section",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"bg-white/5 rounded p-4 h-[320px]",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Treinos por semana (aluna)"}),e.jsx(H,{width:"100%",height:240,children:e.jsxs(Ze,{data:Ke,children:[e.jsx(be,{strokeDasharray:"3 3"}),e.jsx(je,{dataKey:"semana",stroke:"#fff"}),e.jsx(ye,{stroke:"#fff"}),e.jsx(ee,{}),e.jsx(ea,{dataKey:"count",fill:"#FF7A00"})]})})]}),e.jsxs("div",{className:"bg-white/5 rounded p-4 h-[320px]",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Qualidade do sono"}),e.jsx(H,{width:"100%",height:240,children:e.jsxs(Ne,{children:[e.jsx(ve,{data:de,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,labelLine:!1,children:de.map((s,o)=>e.jsx(we,{fill:Ee[o%Ee.length]},o))}),e.jsx(Ce,{})]})})]})]}),e.jsxs("section",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"bg-white/5 rounded p-4 h-[320px]",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Energia x Motivação (semanas)"}),e.jsx(H,{width:"100%",height:240,children:e.jsxs(aa,{data:Ue,children:[e.jsx(be,{strokeDasharray:"3 3"}),e.jsx(je,{dataKey:"idx",stroke:"#fff"}),e.jsx(ye,{stroke:"#fff"}),e.jsx(ee,{}),e.jsx(Se,{type:"monotone",dataKey:"energia",stroke:"#FF7A00"}),e.jsx(Se,{type:"monotone",dataKey:"motivacao",stroke:"#8884d8"})]})})]}),e.jsxs("div",{className:"bg-white/5 rounded p-4 h-[320px]",children:[e.jsx("h3",{className:"font-semibold mb-1",children:"Adesão à alimentação"}),e.jsx("p",{className:"text-xs opacity-75 mb-2",children:"Percentual por resposta da aluna selecionada"}),e.jsx(H,{width:"100%",height:240,children:e.jsxs(Ne,{children:[e.jsx(ve,{data:me,dataKey:"qtd",nameKey:"categoria",cx:"50%",cy:"50%",innerRadius:50,outerRadius:90,label:({pct:s})=>`${s}%`,labelLine:!1,children:me.map((s,o)=>e.jsx(we,{fill:s.color},o))}),e.jsx(ee,{formatter:(s,o,n)=>[`${s} respostas (${n.payload.pct}%)`,n.payload.categoria]}),e.jsx(Ce,{})]})})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Respostas"}),e.jsx("div",{className:"grid gap-2",children:c.map((s,o)=>e.jsxs("div",{className:"bg-white rounded p-3 cursor-pointer hover:bg-gray-100 transition-colors text-black",onClick:()=>P(s),children:[e.jsxs("div",{className:"font-semibold flex items-center gap-3",children:[e.jsx("button",{className:"underline decoration-brand text-left",onClick:n=>{n.stopPropagation(),A(s.nomeCompleto),k(a,s.nomeCompleto),window.scrollTo({top:0,behavior:"smooth"})},children:s.nomeCompleto}),e.jsxs("span",{children:["— ",s.semanaTexto]}),e.jsx("button",{className:"ml-auto text-xs px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:n=>{n.stopPropagation(),P(s)},children:"Detalhes"})]}),e.jsxs("div",{className:"text-sm opacity-75",children:["Força: ",s.treinosForca," | Energia: ",s.energiaGeral," | Sono: ",s.sonoRecuperacao]})]},o))})]})]})]}),J&&e.jsxs("section",{className:"md:hidden bg-white rounded p-4 text-black",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:"Alunas (checklists enviados)"}),e.jsx("button",{className:"px-2 py-1 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>L(!1),children:"Fechar"})]}),e.jsx("div",{className:"grid gap-2",children:ce.map(([s,o])=>e.jsxs("button",{className:"text-left px-3 py-2 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>{A(s),k(a,s),L(!1),window.scrollTo({top:0,behavior:"smooth"})},children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsxs("span",{className:"ml-2 text-sm opacity-70",children:["(",o,")"]})]},s))})]}),m&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 max-w-2xl w-full mx-4 text-black",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h4",{className:"text-lg font-semibold",children:[m.nomeCompleto," — ",m.semanaTexto||(m.createdAt?new Date(m.createdAt).toLocaleDateString("pt-BR"):"")]}),e.jsx("button",{className:"px-2 py-1 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>P(null),children:"Fechar"})]}),e.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[e.jsxs("div",{className:"text-sm opacity-80",children:["Criado em: ",m.createdAt?new Date(m.createdAt).toLocaleString("pt-BR"):"—"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Treinos de força: ",m.treinosForca]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Evolução: ",m.evolucaoDesempenho]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Energia geral: ",m.energiaGeral]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Sono/recuperação: ",m.sonoRecuperacao]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Alimentação no plano: ",m.alimentacaoPlano]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Motivação/humor: ",m.motivacaoHumor]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Cardio sessões: ",m.cardioSessoes]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Tipo de cardio: ",m.tipoCardio]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Duração cardio: ",m.duracaoCardio," min"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Intensidade cardio: ",m.intensidadeCardio]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Dias marcados: ",((he=m.diasMarcados)==null?void 0:he.length)||0]})]}),e.jsx("div",{className:"mt-3 text-sm",children:(pe=m.diasMarcados)!=null&&pe.length?e.jsxs("div",{children:[e.jsx("div",{className:"opacity-80 mb-1",children:"Lista de dias selecionados:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.diasMarcados.map((s,o)=>e.jsx("span",{className:"px-2 py-1 rounded bg-gray-200",children:s},o))})]}):null}),e.jsxs("div",{className:"mt-3 grid gap-2",children:[e.jsxs("div",{className:"text-sm opacity-80",children:["Treino não completado: ",m.treinoNaoCompletado||"—"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Dor/fadiga: ",m.dorOuFadiga||"—"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Ajuste próxima semana: ",m.ajusteProximaSemana||"—"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Comentários adicionais: ",m.comentariosAdicionais||"—"]}),m.whatsapp?e.jsxs("div",{className:"text-sm opacity-80",children:["WhatsApp informado: ",m.whatsapp]}):null]})]})}),X&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:e.jsxs("div",{className:"bg-white rounded p-4 w-[340px] text-black shadow-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Excluir todos os dados"}),e.jsx("p",{className:"text-sm mb-3",children:"Digite a senha do administrador para confirmar a exclusão de TODOS os check-ins."}),e.jsx("input",{type:"password",className:"w-full px-3 py-2 rounded border border-gray-300 mb-3",placeholder:"Senha do administrador",value:g,onChange:s=>y(s.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>t(!1),children:"Cancelar"}),e.jsx("button",{className:"px-3 py-2 rounded bg-red-600 hover:bg-red-700 text-white",onClick:Te,disabled:v,children:v?"Excluindo…":"Excluir"})]})]})}),j&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:e.jsxs("div",{className:"bg-white rounded p-4 w-[360px] text-black shadow-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Enviar Relatório"}),e.jsx("p",{className:"text-sm mb-3",children:"Selecione os canais para enviar o relatório do último check-in."}),e.jsxs("div",{className:"grid gap-2 mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:O,onChange:s=>I(s.target.checked)}),e.jsxs("span",{children:["E-mail do treinador ",S?`( ${S} )`:"(não configurado)"]})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:s=>B(s.target.checked)}),e.jsxs("span",{children:["WhatsApp do treinador ",C?`( +${C} )`:"(não configurado)"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>D(!1),children:"Cancelar"}),e.jsx("button",{className:"brand-btn",onClick:Ge,children:"Enviar"})]})]})})]}):e.jsxs("div",{className:"max-w-md mx-auto px-4 space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Acesso restrito"}),e.jsx("p",{children:"Informe usuário e senha do professor para entrar."}),e.jsx("input",{type:"text",className:"px-3 py-2 rounded bg-white border border-gray-200 w-full text-black",placeholder:"Usuário (ex: professor)",value:h,onChange:s=>p(s.target.value)}),e.jsx("input",{type:"password",className:"px-3 py-2 rounded bg-white border border-gray-200 w-full text-black",placeholder:"Senha",value:a,onChange:s=>i(s.target.value)}),e.jsx("button",{className:"brand-btn",onClick:Le,children:"Entrar"})]})}function ga(){const[a,i]=r.useState(null);return r.useEffect(()=>{(async()=>{try{const h=await te();i(h.photo||null)}catch{}})()},[]),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-white/10 border border-white/20 overflow-hidden flex items-center justify-center",children:a?e.jsx("img",{src:a,alt:"Foto da Prof. Naty",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-xs opacity-70",children:"Prof. Naty"})}),e.jsx("h2",{className:"script-title text-3xl md:text-4xl",children:"personal Nat."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-bold",children:"💪 Obrigado pelo seu check-in!"}),e.jsx("p",{children:"Sua evolução está sendo registrada. Continue firme e focada! 🔥"})]})]})}function fa(){return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[e.jsx("header",{className:"bg-gradient-to-r from-brand to-brand-dark border-b border-gray-800 shadow-brand",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Check-in da Semana 💥"}),e.jsx(Me,{to:"/admin",className:"px-3 py-1 rounded-md bg-white/10 hover:bg-white/20 text-white transition-colors",children:"Admin"})]})}),e.jsx("main",{className:"container mx-auto px-4 py-6",children:e.jsxs(Xe,{children:[e.jsx(Z,{path:"/",element:e.jsx(ua,{})}),e.jsx(Z,{path:"/admin",element:e.jsx(xa,{})}),e.jsx(Z,{path:"/confirmation",element:e.jsx(ga,{})})]})})]})}Re(document.getElementById("root")).render(e.jsx(Qe.StrictMode,{children:e.jsx(Ve,{children:e.jsx(fa,{})})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(()=>{})});
