import{r as c,b as Oe,a as _e}from"./react-BKU87Gzz.js";import{u as Be,L as ge,R as Te,a as q,B as Ke}from"./router-D7DzN0t-.js";import{a as H}from"./vendor-B9HHbEsj.js";import{R as _,B as We,C as re,X as ie,Y as le,T as G,a as Ue,P as ce,b as de,c as me,L as he,d as qe,e as pe}from"./charts-Bv6ZdGAQ.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))m(l);new MutationObserver(l=>{for(const p of l)if(p.type==="childList")for(const h of p.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&m(h)}).observe(document,{childList:!0,subtree:!0});function d(l){const p={};return l.integrity&&(p.integrity=l.integrity),l.referrerPolicy&&(p.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?p.credentials="include":l.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function m(l){if(l.ep)return;l.ep=!0;const p=d(l);fetch(l.href,p)}})();var fe={exports:{}},B={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ge=c,He=Symbol.for("react.element"),Ye=Symbol.for("react.fragment"),ze=Object.prototype.hasOwnProperty,Je=Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qe={key:!0,ref:!0,__self:!0,__source:!0};function be(a,r,d){var m,l={},p=null,h=null;d!==void 0&&(p=""+d),r.key!==void 0&&(p=""+r.key),r.ref!==void 0&&(h=r.ref);for(m in r)ze.call(r,m)&&!Qe.hasOwnProperty(m)&&(l[m]=r[m]);if(a&&a.defaultProps)for(m in r=a.defaultProps,r)l[m]===void 0&&(l[m]=r[m]);return{$$typeof:He,type:a,key:p,ref:h,props:l,_owner:Je.current}}B.Fragment=Ye;B.jsx=be;B.jsxs=be;fe.exports=B;var e=fe.exports,je,ue=Oe;je=ue.createRoot,ue.hydrateRoot;const ye=(()=>{const a=[];try{if(typeof window<"u"){try{const m=new URL(window.location.href),l=(m.searchParams.get("api")||m.searchParams.get("api_base")||"").trim();l&&window.localStorage.setItem("API_BASE",l)}catch{}const d=(window.localStorage.getItem("API_BASE")||"").trim();d&&a.push(d)}}catch{}if(typeof window<"u"){const d=window.location.host||"";/localhost|127\.0\.0\.1/.test(d)?a.push("http://localhost:5175"):a.push(window.location.origin)}else a.push("http://localhost:5175");return!1||a.push("https://checkin-backend.onrender.com"),Array.from(new Set(a.filter(Boolean)))})();function Y(){const a=ye.slice();try{if(typeof window<"u"){const r=(window.localStorage.getItem("API_BASE")||"").trim();r&&a.unshift(r)}}catch{}return Array.from(new Set(a.filter(Boolean)))}function Xe(){return Y()[0]}async function Ve(a,r){let d=null;for(const m of Y())try{return(await H.get(`${m}${a}`,{timeout:5e3,...r||{}})).data}catch(l){d=l;continue}throw d||new Error("all_backends_failed")}async function A(a,r){let d=null;for(const m of Y())try{return(await H.post(`${m}${a}`,r,{timeout:12e3})).data}catch(l){d=l;continue}throw d||new Error("all_backends_failed")}async function Ze(a){try{return await A("/api/admin/login",a)}catch{return{ok:a.username.trim().toLowerCase()==="professor".toLowerCase()&&a.password==="0808"}}}async function Ie(a){try{return await A("/api/checkin",a)}catch{const d="CHECKINS",m=localStorage.getItem(d)||"[]";let l=[];try{l=JSON.parse(m)}catch{l=[]}const p={...a,createdAt:new Date().toISOString()};l.unshift(p);try{localStorage.setItem(d,JSON.stringify(l))}catch{}return{ok:!0,local:!0}}}async function ea(){const a="CHECKINS";let r=[];try{r=JSON.parse(localStorage.getItem(a)||"[]")||[]}catch{r=[]}if(!r.length)return 0;let d=0;const m=[];for(const l of r)try{await A("/api/checkin",l),d++}catch{m.push(l)}try{localStorage.setItem(a,JSON.stringify(m))}catch{}return d}async function aa(a){var r;try{return await Ve("/api/checkins",{params:{adminKey:a==null?void 0:a.adminKey,nome:a==null?void 0:a.nome,from:a==null?void 0:a.from,to:a==null?void 0:a.to}})}catch{const l=localStorage.getItem("CHECKINS")||"[]";let p=[];try{p=JSON.parse(l)}catch{p=[]}const h=(r=a==null?void 0:a.nome)==null?void 0:r.trim();return h&&(p=p.filter(P=>(P.nomeCompleto||"").toLowerCase().includes(h.toLowerCase()))),p}}async function sa(a){const r=ye[0];return(await H.post(`${r}/api/report/pdf`,a,{responseType:"blob"})).data}async function ve(a){return await A("/api/report/send",a)}async function ta(a){try{return await A("/api/admin/clear",a)}catch{if(!(a.adminKey==="0808"))return{ok:!1,deleted:0};const l="CHECKINS",p=localStorage.getItem(l)||"[]";let h=[];try{h=JSON.parse(p)}catch{h=[]}try{localStorage.setItem(l,"[]")}catch{}return{ok:!0,deleted:h.length}}}async function z(a){return{photo:"/profile-fixed.jpg",email:"",whatsapp:"6199422679"}}async function oa(a){try{if(a!=null&&a.adminKey)try{return await A("/api/admin/profile",a)}catch{const{adminKey:d,...m}=a;return await A("/api/profile",m)}else return await A("/api/profile",a)}catch{return{ok:!1}}}const na={nomeCompleto:"",semanaTexto:"",diasMarcados:[],treinosForca:"0",evolucaoDesempenho:"Ainda nÃ£o",treinoNaoCompletado:"",dorOuFadiga:"",cardioSessoes:"0",tipoCardio:"",duracaoCardio:"20",intensidadeCardio:"Leve",energiaGeral:"MÃ©dia",sonoRecuperacao:"Regular",alimentacaoPlano:"Sim, em parte",motivacaoHumor:"Boa",ajusteProximaSemana:"",comentariosAdicionais:"",whatsapp:"",fotoPerfil:""};function ra(){const[a,r]=c.useState(na),[d,m]=c.useState(!1),l=Be(),[p,h]=c.useState(null);c.useEffect(()=>{const s=u=>{u.preventDefault(),h(u)};return window.addEventListener("beforeinstallprompt",s),()=>window.removeEventListener("beforeinstallprompt",s)},[]);const P=async()=>{const s=/iPhone|iPad|iPod/i.test(navigator.userAgent),u=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone;try{if(p){p.prompt(),await p.userChoice,h(null);return}if(s&&!u){alert("No iPhone: toque em Compartilhar â†’ Adicionar Ã  Tela de InÃ­cio.");return}alert("Para instalar, use o menu do navegador: â€œAdicionar Ã  tela inicialâ€.")}catch{}},b=(s,u)=>{r(f=>({...f,[s]:u}))},[Ne,S]=c.useState(null),[M,w]=c.useState("");c.useEffect(()=>{const s=new AbortController,{signal:u}=s;return(async()=>{try{const f=await z({signal:u});S(f.photo||null),w((f.whatsapp||"").replace(/\D/g,""))}catch{}})(),()=>{s.abort()}},[]);const R=async s=>{var u;s.preventDefault();try{m(!0),await Ie(a);const f="",y=(M||""||"").replace(/\D/g,"");try{await ve({...a,tipo:"checkin_submitted",adminEmail:f,adminWhatsapp:y})}catch{}if(y){const j=[`Novo check-in: ${a.nomeCompleto} â€” ${a.semanaTexto}`,`Treinos de forÃ§a: ${a.treinosForca}`,`EvoluÃ§Ã£o: ${a.evolucaoDesempenho}`,`Energia: ${a.energiaGeral}`,`Sono: ${a.sonoRecuperacao}`,`AlimentaÃ§Ã£o: ${a.alimentacaoPlano}`,`Cardio: ${a.cardioSessoes} sessÃµes (${a.tipoCardio}, ${a.duracaoCardio} min, ${a.intensidadeCardio})`,a.treinoNaoCompletado?`Treino nÃ£o completado: ${a.treinoNaoCompletado}`:"",a.dorOuFadiga?`Dor/fadiga: ${a.dorOuFadiga}`:"",a.ajusteProximaSemana?`Ajuste prÃ³xima semana: ${a.ajusteProximaSemana}`:"",a.comentariosAdicionais?`ComentÃ¡rios: ${a.comentariosAdicionais}`:"",(u=a.diasMarcados)!=null&&u.length?`Dias marcados: ${a.diasMarcados.join(", ")}`:""].filter(Boolean),L=encodeURIComponent(j.join(`
`)),O=`https://api.whatsapp.com/send?phone=${y}&text=${L}`;try{window.open(O,"_blank")}catch{}}l("/confirmation")}catch{alert("Erro ao enviar. Tente novamente.")}finally{m(!1)}},[x,F]=c.useState(()=>{const s=new Date;return new Date(s.getFullYear(),s.getMonth(),1)}),E=c.useMemo(()=>x.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),[x]),k=c.useMemo(()=>{const s=new Date(x),f=new Date(x.getFullYear(),x.getMonth()+1,0).getDate(),v=s.getDay(),y=[];for(let j=0;j<v;j++)y.push(null);for(let j=1;j<=f;j++)y.push(j);return y},[x]),o=(s,u,f)=>{const v=String(u+1).padStart(2,"0"),y=String(f).padStart(2,"0");return`${s}-${v}-${y}`},D=s=>(a.diasMarcados||[]).includes(s),T=s=>{if(!s)return;const u=x.getFullYear(),f=x.getMonth(),v=o(u,f,s);r(y=>{const j=new Set(y.diasMarcados||[]);return j.has(v)?j.delete(v):j.add(v),{...y,diasMarcados:Array.from(j).sort()}})},$=()=>F(new Date(x.getFullYear(),x.getMonth()-1,1)),K=()=>F(new Date(x.getFullYear(),x.getMonth()+1,1));return e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-white/10 border border-white/20 overflow-hidden flex items-center justify-center",children:e.jsx("img",{src:"/profile-fixed.jpg",alt:"Foto fixa de perfil",className:"w-full h-full object-cover object-top"})}),e.jsx("h1",{className:"script-title text-3xl md:text-4xl",children:"personal Nat."})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Nome completo"}),e.jsx("input",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",value:a.nomeCompleto,onChange:s=>b("nomeCompleto",s.target.value),required:!0})]}),e.jsx("div",{className:"grid gap-1",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Semana de â€¦ atÃ© â€¦"})}),e.jsxs("div",{className:"grid gap-2 rounded-lg border border-white/10 bg-white/5 p-2 w-[220px]",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("button",{type:"button",onClick:$,className:"px-1 py-0.5 rounded bg-white/10 hover:bg-white/20",children:"â—€"}),e.jsx("span",{className:"font-semibold",children:E}),e.jsx("button",{type:"button",onClick:K,className:"px-1 py-0.5 rounded bg-white/10 hover:bg-white/20",children:"â–¶"})]}),e.jsx("div",{className:"grid grid-cols-7 text-center text-[11px] text-white/70",children:["Dom","Seg","Ter","Qua","Qui","Sex","SÃ¡b"].map(s=>e.jsx("div",{className:"py-1",children:s},s))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:k.map((s,u)=>{if(s===null)return e.jsx("div",{},u);const f=o(x.getFullYear(),x.getMonth(),s),v=D(f);return e.jsxs("button",{type:"button",onClick:()=>T(s),className:`relative w-8 h-8 rounded-md border border-white/10 bg-white/5 hover:bg-white/10 transition ${v?"ring-2 ring-blue-400":""}`,children:[e.jsx("span",{className:"text-[11px]",children:s}),v&&e.jsx("span",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-blue-400"})]},u)})}),a.diasMarcados&&a.diasMarcados.length>0&&e.jsxs("div",{className:"text-xs text-white/70",children:["Dias marcados: ",a.diasMarcados.join(", ")]})]})]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Quantos treinos de forÃ§a/hipertrofia vocÃª fez esta semana?"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:["0","1-2","3-4","5+"].map(s=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"treinosForca",checked:a.treinosForca===s,onChange:()=>b("treinosForca",s)}),e.jsx("span",{children:s==="5+"?"5 ou mais":s})]},s))})]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Sentiu evoluÃ§Ã£o no desempenho (carga, repetiÃ§Ãµes, tÃ©cnica)?"}),["Sim, bastante","Sim, um pouco","Ainda nÃ£o"].map(s=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"evolucao",checked:a.evolucaoDesempenho===s,onChange:()=>b("evolucaoDesempenho",s)}),e.jsx("span",{children:s})]},s))]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Teve algum treino que nÃ£o conseguiu completar? Qual e por quÃª?"}),e.jsx("textarea",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",rows:3,value:a.treinoNaoCompletado,onChange:s=>b("treinoNaoCompletado",s.target.value)})]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Sentiu alguma dor, desconforto ou fadiga alÃ©m do habitual? Se sim, onde/como?"}),e.jsx("textarea",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",rows:3,value:a.dorOuFadiga,onChange:s=>b("dorOuFadiga",s.target.value)})]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Quantas sessÃµes de cardio vocÃª fez essa semana?"}),["0","1-2","3-4","5+"].map(s=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"cardioSessoes",checked:a.cardioSessoes===s,onChange:()=>b("cardioSessoes",s)}),e.jsx("span",{children:s==="5+"?"5 ou mais":s})]},s))]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Tipo de cardio feito"}),e.jsx("input",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",value:a.tipoCardio,onChange:s=>b("tipoCardio",s.target.value)})]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"DuraÃ§Ã£o mÃ©dia de cada sessÃ£o"}),["20","30","45+"].map(s=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"duracaoCardio",checked:a.duracaoCardio===s,onChange:()=>b("duracaoCardio",s)}),e.jsx("span",{children:s==="45+"?"45+ min":`${s} min`})]},s))]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Intensidade do cardio"}),["Leve","Moderada","Alta"].map(s=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"intensidadeCardio",checked:a.intensidadeCardio===s,onChange:()=>b("intensidadeCardio",s)}),e.jsx("span",{children:s})]},s))]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Energia/disposiÃ§Ã£o geral essa semana"}),["Excelente","Boa","MÃ©dia","Baixa"].map(s=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"energiaGeral",checked:a.energiaGeral===s,onChange:()=>b("energiaGeral",s)}),e.jsx("span",{children:s})]},s))]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"Sono e recuperaÃ§Ã£o"}),["Muito bom","Bom","Regular","Ruim"].map(s=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"sonoRecuperacao",checked:a.sonoRecuperacao===s,onChange:()=>b("sonoRecuperacao",s)}),e.jsx("span",{children:s})]},s))]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"AlimentaÃ§Ã£o seguiu conforme o plano indicado?"}),["Sim, totalmente","Sim, em parte","NÃ£o muito"].map(s=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"alimentacaoPlano",checked:a.alimentacaoPlano===s,onChange:()=>b("alimentacaoPlano",s)}),e.jsx("span",{children:s})]},s))]}),e.jsxs("fieldset",{className:"grid gap-2",children:[e.jsx("legend",{className:"font-semibold",children:"MotivaÃ§Ã£o e humor para treinar na prÃ³xima semana"}),["Muito alta","Boa","MÃ©dia","Preciso de impulso"].map(s=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"motivacaoHumor",checked:a.motivacaoHumor===s,onChange:()=>b("motivacaoHumor",s)}),e.jsx("span",{children:s})]},s))]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"Quer que eu ajuste algo para a prÃ³xima semana?"}),e.jsx("textarea",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",rows:3,value:a.ajusteProximaSemana,onChange:s=>b("ajusteProximaSemana",s.target.value)})]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"ComentÃ¡rios adicionais"}),e.jsx("textarea",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",rows:3,value:a.comentariosAdicionais,onChange:s=>b("comentariosAdicionais",s.target.value)})]}),e.jsxs("label",{className:"grid gap-2",children:[e.jsx("span",{children:"WhatsApp (opcional)"}),e.jsx("input",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",value:a.whatsapp,onChange:s=>b("whatsapp",s.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:P,className:"px-3 py-2 rounded bg-white/10 hover:bg-white/20",children:"Instalar app"}),e.jsx("button",{type:"submit",className:"brand-btn",disabled:d,children:d?"Enviandoâ€¦":"Enviar Check-in"})]})]})}const xe=["#FF7A00","#aaa","#666","#fff"];function ia(){var te,oe,ne;const[a,r]=c.useState(""),[d,m]=c.useState(""),[l,p]=c.useState(!1),[h,P]=c.useState([]),[b,Ne]=c.useState(""),[S,M]=c.useState(""),[w,R]=c.useState(""),[x,F]=c.useState([]),[E,k]=c.useState(""),[o,D]=c.useState(null),[T,$]=c.useState(!1),[K,s]=c.useState(!1),[u,f]=c.useState(""),[v,y]=c.useState(!1),[j,L]=c.useState(!1),[W,O]=c.useState(!1),[J,Q]=c.useState(!1),[da,we]=c.useState(null),[ma,ha]=c.useState(null),[pa,ua]=c.useState(!1),[X,V]=c.useState(""),[xa,Se]=c.useState(""),[ga,fa]=c.useState(!1),[Z,I]=c.useState(!1);c.useEffect(()=>{localStorage.removeItem("ADMIN_KEY"),localStorage.removeItem("ADMIN_USER");const t=new AbortController,{signal:n}=t;(async()=>{try{const i=await z({signal:n});we(i.photo||null),M((i.email||"").trim()),R((i.whatsapp||"").trim())}catch{M(""),R("")}})();try{Se(Xe()||"")}catch{}return()=>{t.abort()}},[]);const C=async(t,n)=>{const i=await aa({adminKey:t,nome:n||void 0});P(i),n||F(i)},Ce=async()=>{const t=d.trim(),n=a.trim();if(!t||!n)return alert("Informe usuÃ¡rio e senha");try{if(!(await Ze({username:t,password:n})).ok)throw new Error("invalid");p(!0);try{await C(n)}catch{}}catch{alert("UsuÃ¡rio ou senha invÃ¡lidos"),p(!1)}},ke=()=>{f(""),s(!0)},Ae=async()=>{const t=u.trim();if(!t)return alert("Informe a senha do administrador.");try{y(!0);const n=await ta({adminKey:t});if(!n.ok)throw new Error("failed");P([]),F([]),D(null);try{await C(t)}catch{}s(!1),alert(`Dados excluÃ­dos. Registros removidos: ${n.deleted}`)}catch{alert("Senha invÃ¡lida ou erro ao excluir os dados.")}finally{y(!1)}},Ee=async()=>{const t=(S||"").trim(),n=(w||"").replace(/\D/g,"");I(!0);try{if(!(await oa({email:t,whatsapp:n,adminKey:(a||"").trim()||void 0})).ok)throw new Error("invalid");V("Contatos atualizados (e-mail e WhatsApp)."),setTimeout(()=>V(""),5e3)}catch{alert("Erro ao salvar contatos.")}finally{I(!1)}};c.useMemo(()=>{const t={};for(const n of h){const i=n.nomeCompleto,N=n.treinosForca==="0"?0:n.treinosForca==="1-2"?2:n.treinosForca==="3-4"?4:5;t[i]=(t[i]||0)+N}return Object.entries(t).map(([n,i])=>({name:n,count:i}))},[h]);const Pe=c.useMemo(()=>{const t=new Set;for(const n of x)n.nomeCompleto&&t.add(n.nomeCompleto);return Array.from(t).sort((n,i)=>n.localeCompare(i))},[x]),ee=c.useMemo(()=>{const t={};for(const n of x){const i=n.nomeCompleto;i&&(t[i]=(t[i]||0)+1)}return Object.entries(t).sort((n,i)=>n[0].localeCompare(i[0]))},[x]),De=c.useMemo(()=>h.map(n=>{const i=n.treinosForca==="0"?0:n.treinosForca==="1-2"?2:n.treinosForca==="3-4"?4:5;return{semana:n.semanaTexto&&n.semanaTexto.trim().length?n.semanaTexto:n.createdAt?new Date(n.createdAt).toLocaleDateString("pt-BR"):"",count:i}}).reverse(),[h]),ae=c.useMemo(()=>{const t=["Muito bom","Bom","Regular","Ruim"],n={"Muito bom":0,Bom:0,Regular:0,Ruim:0};for(const i of h)n[i.sonoRecuperacao]++;return t.map(i=>({name:i,value:n[i]}))},[h]),Me=c.useMemo(()=>{const t=["Excelente","Boa","MÃ©dia","Baixa"],n=["Muito alta","Boa","MÃ©dia","Preciso de impulso"],i=g=>t.indexOf(g),N=g=>n.indexOf(g);return h.map((g,U)=>({idx:U+1,energia:i(g.energiaGeral),motivacao:N(g.motivacaoHumor),nome:g.nomeCompleto}))},[h]),se=c.useMemo(()=>{const t=["Sim, totalmente","Sim, em parte","NÃ£o muito"],n={"Sim, totalmente":"#22c55e","Sim, em parte":"#f59e0b","NÃ£o muito":"#ef4444"},i={"Sim, totalmente":0,"Sim, em parte":0,"NÃ£o muito":0};for(const g of h)i[g.alimentacaoPlano]++;const N=h.length||1;return t.map(g=>({categoria:g,qtd:i[g],pct:Math.round(i[g]/N*100),color:n[g]}))},[h]),Re=async()=>{var g;const t=E||((g=h[0])==null?void 0:g.nomeCompleto)||"";if(!t)return alert("Selecione uma aluna para exportar.");const n=await sa({nome:t}),i=URL.createObjectURL(n),N=document.createElement("a");N.href=i,N.download=`relatorio-${t}.pdf`,N.click(),URL.revokeObjectURL(i)},Fe=()=>{if(!h.length)return alert("Sem dados");O(!!S),Q(!!w),L(!0)},$e=async()=>{if(!h.length)return alert("Sem dados");const t=h[0],n=W&&!!S,i=J&&!!w;if(!n&&!i)return alert("Selecione pelo menos um canal (E-mail ou WhatsApp).");try{await ve({...t,tipo:"weekly_report",adminEmail:n?S:"",adminWhatsapp:i?w:""})}catch{}finally{L(!1)}if(i){const N=(w||"").replace(/\D/g,"");if(N){const g=[`Novo check-in: ${t.nomeCompleto} â€” ${t.semanaTexto||""}`,`Treinos de forÃ§a: ${t.treinosForca}`,`Energia: ${t.energiaGeral}`,`Sono: ${t.sonoRecuperacao}`,`AlimentaÃ§Ã£o: ${t.alimentacaoPlano}`].filter(Boolean),U=encodeURIComponent(g.join(`
`)),Le=`https://api.whatsapp.com/send?phone=${N}&text=${U}`;try{window.open(Le,"_blank")}catch{}}}alert(`RelatÃ³rio enviado${n?" por e-mail":""}${i?n?" e WhatsApp":" por WhatsApp":""}!`)};return l?e.jsxs("div",{className:"max-w-6xl mx-auto px-4 space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Painel de AdministraÃ§Ã£o"}),X&&e.jsx("div",{className:"px-3 py-2 rounded bg-green-600/20 border border-green-500/40 text-green-100",children:X}),e.jsxs("div",{className:"flex items-end justify-between flex-wrap gap-2",children:[e.jsx(ge,{to:"/",className:"brand-btn",children:"Voltar"}),e.jsxs("div",{className:"flex items-end gap-3 flex-wrap",children:[e.jsx("button",{className:"px-3 py-2 rounded bg-red-600 hover:bg-red-700",title:"Excluir todos os dados (requer senha)",onClick:ke,children:"Excluir dados"}),e.jsx("button",{className:"px-3 py-2 rounded bg-white/10 hover:bg-white/20",title:"Todos os alunos",onClick:()=>{$(!0),k(""),C(a,void 0),window.scrollTo({top:0,behavior:"smooth"})},children:"ðŸ‘¥"}),E&&e.jsxs("div",{className:"flex items-center gap-2 text-sm opacity-80",children:[e.jsxs("span",{children:["Filtrando: ",e.jsx("span",{className:"font-semibold",children:E})]}),e.jsx("button",{className:"px-2 py-1 rounded bg-white/10 hover:bg-white/20",onClick:()=>{k(""),C(a,void 0)},children:"Limpar filtro"})]}),e.jsxs("select",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",value:E,onChange:t=>{const n=t.target.value;k(n),C(a,n||void 0)},children:[e.jsx("option",{value:"",children:"Todas alunas"}),Pe.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("button",{className:"brand-btn",onClick:()=>C(a,E||void 0),children:"Atualizar"}),e.jsx("button",{className:"brand-btn",onClick:Re,children:"Exportar PDF"}),e.jsx("button",{className:"brand-btn",onClick:Fe,children:"Enviar RelatÃ³rio"})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-[280px_1fr]",children:[e.jsx("aside",{className:"hidden md:block",children:e.jsxs("div",{className:"bg-white rounded p-4 text-black",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Alunas (checklists enviados)"}),e.jsx("div",{className:"grid gap-2",children:ee.map(([t,n])=>e.jsxs("button",{className:"text-left px-3 py-2 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>{k(t),C(a,t),window.scrollTo({top:0,behavior:"smooth"})},children:[e.jsx("span",{className:"font-semibold",children:t}),e.jsxs("span",{className:"ml-2 text-sm opacity-70",children:["(",n,")"]})]},t))})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("section",{className:"bg-white/5 rounded p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"ConfiguraÃ§Ãµes de contato"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("label",{className:"grid gap-1",children:[e.jsx("span",{className:"text-sm opacity-80",children:"E-mail do treinador"}),e.jsx("input",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",placeholder:"ex: seuemail@dominio.com",value:S,onChange:t=>M(t.target.value)})]}),e.jsxs("label",{className:"grid gap-1",children:[e.jsx("span",{className:"text-sm opacity-80",children:"WhatsApp do treinador (com DDD)"}),e.jsx("input",{className:"px-3 py-2 rounded bg-white/5 border border-white/10",placeholder:"ex: 5599999999999",value:w,onChange:t=>R(t.target.value)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("button",{className:"brand-btn",type:"button",onClick:Ee,disabled:Z,children:Z?"Salvandoâ€¦":"Salvar contatos"}),e.jsx("span",{className:"text-xs opacity-60",children:"Usado no envio por e-mail/WhatsApp."})]})]}),e.jsxs("section",{className:"bg-white/5 rounded p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Foto do site"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-[auto_1fr] items-center",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-white/10 border border-white/20 overflow-hidden flex items-center justify-center",children:e.jsx("img",{src:"/profile-fixed.jpg",alt:"Foto fixa do site",className:"w-full h-full object-cover object-top"})}),e.jsx("div",{className:"grid gap-2",children:e.jsx("span",{className:"text-sm opacity-70",children:"Foto fixa no perfil (somente leitura). EdiÃ§Ã£o desativada."})})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"bg-white/5 rounded p-4 h-[320px]",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Treinos por semana (aluna)"}),e.jsx(_,{width:"100%",height:240,children:e.jsxs(We,{data:De,children:[e.jsx(re,{strokeDasharray:"3 3"}),e.jsx(ie,{dataKey:"semana",stroke:"#fff"}),e.jsx(le,{stroke:"#fff"}),e.jsx(G,{}),e.jsx(Ue,{dataKey:"count",fill:"#FF7A00"})]})})]}),e.jsxs("div",{className:"bg-white/5 rounded p-4 h-[320px]",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Qualidade do sono"}),e.jsx(_,{width:"100%",height:240,children:e.jsxs(ce,{children:[e.jsx(de,{data:ae,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,labelLine:!1,children:ae.map((t,n)=>e.jsx(me,{fill:xe[n%xe.length]},n))}),e.jsx(he,{})]})})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"bg-white/5 rounded p-4 h-[320px]",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Energia x MotivaÃ§Ã£o (semanas)"}),e.jsx(_,{width:"100%",height:240,children:e.jsxs(qe,{data:Me,children:[e.jsx(re,{strokeDasharray:"3 3"}),e.jsx(ie,{dataKey:"idx",stroke:"#fff"}),e.jsx(le,{stroke:"#fff"}),e.jsx(G,{}),e.jsx(pe,{type:"monotone",dataKey:"energia",stroke:"#FF7A00"}),e.jsx(pe,{type:"monotone",dataKey:"motivacao",stroke:"#8884d8"})]})})]}),e.jsxs("div",{className:"bg-white/5 rounded p-4 h-[320px]",children:[e.jsx("h3",{className:"font-semibold mb-1",children:"AdesÃ£o Ã  alimentaÃ§Ã£o"}),e.jsx("p",{className:"text-xs opacity-75 mb-2",children:"Percentual por resposta da aluna selecionada"}),e.jsx(_,{width:"100%",height:240,children:e.jsxs(ce,{children:[e.jsx(de,{data:se,dataKey:"qtd",nameKey:"categoria",cx:"50%",cy:"50%",innerRadius:50,outerRadius:90,label:({pct:t})=>`${t}%`,labelLine:!1,children:se.map((t,n)=>e.jsx(me,{fill:t.color},n))}),e.jsx(G,{formatter:(t,n,i)=>[`${t} respostas (${i.payload.pct}%)`,i.payload.categoria]}),e.jsx(he,{})]})})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Respostas"}),e.jsx("div",{className:"grid gap-2",children:h.map((t,n)=>e.jsxs("div",{className:"bg-white rounded p-3 cursor-pointer hover:bg-gray-100 transition-colors text-black",onClick:()=>D(t),children:[e.jsxs("div",{className:"font-semibold flex items-center gap-3",children:[e.jsx("button",{className:"underline decoration-brand text-left",onClick:i=>{i.stopPropagation(),k(t.nomeCompleto),C(a,t.nomeCompleto),window.scrollTo({top:0,behavior:"smooth"})},children:t.nomeCompleto}),e.jsxs("span",{children:["â€” ",t.semanaTexto]}),e.jsx("button",{className:"ml-auto text-xs px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:i=>{i.stopPropagation(),D(t)},children:"Detalhes"})]}),e.jsxs("div",{className:"text-sm opacity-75",children:["ForÃ§a: ",t.treinosForca," | Energia: ",t.energiaGeral," | Sono: ",t.sonoRecuperacao]})]},n))})]})]})]}),T&&e.jsxs("section",{className:"md:hidden bg-white rounded p-4 text-black",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:"Alunas (checklists enviados)"}),e.jsx("button",{className:"px-2 py-1 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>$(!1),children:"Fechar"})]}),e.jsx("div",{className:"grid gap-2",children:ee.map(([t,n])=>e.jsxs("button",{className:"text-left px-3 py-2 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>{k(t),C(a,t),$(!1),window.scrollTo({top:0,behavior:"smooth"})},children:[e.jsx("span",{className:"font-semibold",children:t}),e.jsxs("span",{className:"ml-2 text-sm opacity-70",children:["(",n,")"]})]},t))})]}),o?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 max-w-2xl w-full mx-4 text-black",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h4",{className:"text-lg font-semibold",children:[(o==null?void 0:o.nomeCompleto)??"â€”"," â€” ",(o==null?void 0:o.semanaTexto)||(o!=null&&o.createdAt?new Date(o==null?void 0:o.createdAt).toLocaleDateString("pt-BR"):"")]}),e.jsx("button",{className:"px-2 py-1 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>D(null),children:"Fechar"})]}),e.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[e.jsxs("div",{className:"text-sm opacity-80",children:["Criado em: ",o!=null&&o.createdAt?new Date(o==null?void 0:o.createdAt).toLocaleString("pt-BR"):"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Treinos de forÃ§a: ",(o==null?void 0:o.treinosForca)??"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["EvoluÃ§Ã£o: ",(o==null?void 0:o.evolucaoDesempenho)??"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Energia geral: ",(o==null?void 0:o.energiaGeral)??"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Sono/recuperaÃ§Ã£o: ",(o==null?void 0:o.sonoRecuperacao)??"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["AlimentaÃ§Ã£o no plano: ",(o==null?void 0:o.alimentacaoPlano)??"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["MotivaÃ§Ã£o/humor: ",(o==null?void 0:o.motivacaoHumor)??"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Cardio sessÃµes: ",(o==null?void 0:o.cardioSessoes)??"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Tipo de cardio: ",(o==null?void 0:o.tipoCardio)??"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["DuraÃ§Ã£o cardio: ",(o==null?void 0:o.duracaoCardio)??0," min"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Intensidade cardio: ",(o==null?void 0:o.intensidadeCardio)??"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Dias marcados: ",((te=o==null?void 0:o.diasMarcados)==null?void 0:te.length)||0]})]}),e.jsx("div",{className:"mt-3 text-sm",children:(oe=o==null?void 0:o.diasMarcados)!=null&&oe.length?e.jsxs("div",{children:[e.jsx("div",{className:"opacity-80 mb-1",children:"Lista de dias selecionados:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(ne=o==null?void 0:o.diasMarcados)==null?void 0:ne.map((t,n)=>e.jsx("span",{className:"px-2 py-1 rounded bg-gray-200",children:t},n))})]}):null}),e.jsxs("div",{className:"mt-3 grid gap-2",children:[e.jsxs("div",{className:"text-sm opacity-80",children:["Treino nÃ£o completado: ",(o==null?void 0:o.treinoNaoCompletado)||"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Dor/fadiga: ",(o==null?void 0:o.dorOuFadiga)||"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["Ajuste prÃ³xima semana: ",(o==null?void 0:o.ajusteProximaSemana)||"â€”"]}),e.jsxs("div",{className:"text-sm opacity-80",children:["ComentÃ¡rios adicionais: ",(o==null?void 0:o.comentariosAdicionais)||"â€”"]}),o!=null&&o.whatsapp?e.jsxs("div",{className:"text-sm opacity-80",children:["WhatsApp informado: ",o.whatsapp]}):null]})]})}):null,K&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:e.jsxs("div",{className:"bg-white rounded p-4 w-[340px] text-black shadow-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Excluir todos os dados"}),e.jsx("p",{className:"text-sm mb-3",children:"Digite a senha do administrador para confirmar a exclusÃ£o de TODOS os check-ins."}),e.jsx("input",{type:"password",className:"w-full px-3 py-2 rounded border border-gray-300 mb-3",placeholder:"Senha do administrador",value:u,onChange:t=>f(t.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>s(!1),children:"Cancelar"}),e.jsx("button",{className:"px-3 py-2 rounded bg-red-600 hover:bg-red-700 text-white",onClick:Ae,disabled:v,children:v?"Excluindoâ€¦":"Excluir"})]})]})}),j&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:e.jsxs("div",{className:"bg-white rounded p-4 w-[360px] text-black shadow-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Enviar RelatÃ³rio"}),e.jsx("p",{className:"text-sm mb-3",children:"Selecione os canais para enviar o relatÃ³rio do Ãºltimo check-in."}),e.jsxs("div",{className:"grid gap-2 mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:W,onChange:t=>O(t.target.checked)}),e.jsxs("span",{children:["E-mail do treinador ",S?`( ${S} )`:"(nÃ£o configurado)"]})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:J,onChange:t=>Q(t.target.checked)}),e.jsxs("span",{children:["WhatsApp do treinador ",w?`( +${w} )`:"(nÃ£o configurado)"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>L(!1),children:"Cancelar"}),e.jsx("button",{className:"brand-btn",onClick:$e,children:"Enviar"})]})]})})]}):e.jsxs("div",{className:"max-w-md mx-auto px-4 space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Acesso restrito"}),e.jsx("p",{children:"Informe usuÃ¡rio e senha do professor para entrar."}),e.jsx("input",{type:"text",className:"px-3 py-2 rounded bg-white border border-gray-200 w-full text-black",placeholder:"UsuÃ¡rio (ex: professor)",value:d,onChange:t=>m(t.target.value)}),e.jsx("input",{type:"password",className:"px-3 py-2 rounded bg-white border border-gray-200 w-full text-black",placeholder:"Senha",value:a,onChange:t=>r(t.target.value)}),e.jsx("button",{className:"brand-btn",onClick:Ce,children:"Entrar"})]})}function la(){const[a,r]=c.useState(null);return c.useEffect(()=>{const d=new AbortController,{signal:m}=d;return(async()=>{try{const l=await z({signal:m});r(l.photo||null)}catch{}})(),()=>{d.abort()}},[]),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-white/10 border border-white/20 overflow-hidden flex items-center justify-center",children:e.jsx("img",{src:"/profile-fixed.jpg",alt:"Foto fixa",className:"w-full h-full object-cover object-top"})}),e.jsx("h2",{className:"script-title text-3xl md:text-4xl",children:"personal Nat."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-bold",children:"ðŸ’ª Obrigado pelo seu check-in!"}),e.jsx("p",{children:"Sua evoluÃ§Ã£o estÃ¡ sendo registrada. Continue firme e focada! ðŸ”¥"})]})]})}function ca(){return c.useEffect(()=>{(async()=>{try{await ea()}catch{}})()},[]),e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[e.jsx("header",{className:"bg-gradient-to-r from-brand to-brand-dark border-b border-gray-800 shadow-brand",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Check-in da Semana ðŸ’¥"}),e.jsx(ge,{to:"/admin",className:"px-3 py-1 rounded-md bg-white/10 hover:bg-white/20 text-white transition-colors",children:"Admin"})]})}),e.jsx("main",{className:"container mx-auto px-4 py-6",children:e.jsxs(Te,{children:[e.jsx(q,{path:"/",element:e.jsx(ra,{})}),e.jsx(q,{path:"/admin",element:e.jsx(ia,{})}),e.jsx(q,{path:"/confirmation",element:e.jsx(la,{})})]})})]})}je(document.getElementById("root")).render(e.jsx(_e.StrictMode,{children:e.jsx(Ke,{children:e.jsx(ca,{})})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(()=>{})});
